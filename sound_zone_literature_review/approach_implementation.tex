The ``Pressure Matching'' (PM) is widely used in literature to solve the sound zone problem.
In this section, a ``Multi-Zone Pressure Matching'' (MZ-PM) algorithm will be derived.
The motivation for introducing this algorithm is that it will be used as the foundation on which the perceptual sound zone algorithm will be built, 
as it was found that perceptual model was easily intergratable into the pressure matching framework.

In the typical PM approach, the resulting loudspeaker input signals $x^{(l)}[n]$ are determined for just a single zone.
Here, the loudspeaker input signals are found such that the a target audio is achieved in one zone, while leakage is minimized to other zones.
If the solution for multiple zones is desired, than multiple PM problems must be solved and their resulting loudspeaker input signals combined. 
In the MZ-PM approach, the loudspeaker input signals are instead determined for jointly for all zones.

In a two zone approach, the loudspeaker input signals $x^{(l)}[n]$ are decomposed into two parts as follows:
\begin{equation}
    x^{(l)}[n] = x_\za^{(l)}[n] + x_\zb^{(l)}[n]
\end{equation}
Here, $x_\za^{(l)}[n]$ and $x_\zb^{(l)}[n]$ are the parts of the loudspeaker input signal responsible for reproducing the target sound pressure 
in zone $\za$ and $\zb$ respectively.

Through this decomposition, it is possible to consider the sound pressure that arises due to the separate loudspeaker input signals:
\begin{align}
    p_\zz^{(m)}[n] &= \sum_{l=0}^{N_L} \left(h^{(l,m)} \ast x_\zz^{(l)}\right)[n] 
\end{align}
Where $\zz \in \left(\za,\,\zb\right)$ represents either zones.
Here, $p_\za^{(m)}[n]$ and $p_\zb^{(m)}[n]$ can be understood to be the pressure that arises due to 
playing loudspeaker input signals $x_\za^{(l)}[n]$ and $x_\zb^{(l)}[n]$ respectively. 
The total sound pressure is then given by the addition of the two sound pressures:
\begin{equation}
    p^{(m)}[n] = p_\za^{(m)}[n] + p_\zb^{(m)}[n]
\end{equation}
The idea in this approach is to chose $x_\za^{(l)}[n]$ and such that the resulting pressure $p_\za^{(m)}[n]$ attains the target sound pressure $t^{(m)}[n]$ in all $m \in A$.   

At the same time however, $p_\za^{(m)}[n]$ should not result in any sound pressure in all $m \in B$.
Any sound pressure resulting from $x_\za^{(l)}[n]$ in zone $\zb$ is essentially leakage, or cross-talk between zones. 
Similar arguments can be given for $x_\zb^{(l)}[n]$.

In the MZ-PM approach, the loudspeaker input signals $x_\za^{(l)}[n]$ and $x_\zb^{(l)}[n]$ that attain the target with minimal leakage can be found by 
minimizing the difference between the intended pressure and the realized pressure as follows:
\begin{align}
    \argmin{x_\za^{(l)}[n],\,x_\zb^{(l)}[n]\,\forall\,l}{
       &\sum_{m\in A} \norm[2][2]{p_\za^{(m)}[n] - t^{(m)}[n]} +
        \sum_{m\in A} \norm[2][2]{p_\zb^{(m)}[n]} + \\
       &\sum_{m\in B} \norm[2][2]{p_\zb^{(m)}[n] - t^{(m)}[n]} + 
        \sum_{m\in B} \norm[2][2]{p_\za^{(m)}[n]}
    }
\end{align}

Here, the first two terms can be understood as the reproduction error and the leakage for zone $\za$.
Similarly, the last two terms are the reproduction error and leakage for zone $\zb$. 
To make this more clear, the following definitions are introduced:
\begin{align}
    \text{RE}_\zz &= \sum_{m\in A} \norm[2][2]{p_\za^{(m)}[n] - t^{(m)}[n]} \\
    \text{LE}_\zz &= \sum_{m\in A} \norm[2][2]{p_\zb^{(m)}[n]} 
\end{align}

Here, $\text{RE}_\zz$ is the reproduction error and $\text{LE}_\zz$ is the leakage error in zone $\zz \in \left(\za,\,\zb\right)$.
This allows for the following rewrite of the previously introduced optimization problem:

\begin{align}
    \argmin{x_\za^{(l)}[n],\,x_\zb^{(l)}[n]\,\forall\,l}{
       &\text{RE}_\za + \text{LE}_\za + \text{RE}_\zb + \text{LE}_\zb
    }
\end{align}

From this it becomes clear that this approach results in trade-off between minimizing the reproduction errors $\text{RE}_\zz$ 
and leakages $\text{LE}_\zz$. 
Some pressure matching approaches attempt to control this trade-off by introducing weights for the different error terms, 
or by adding constraints.
Choosing constraints can however be challenging as the mean square pressure error is difficult to interpret.

The algorithm above will form the basis of the perceptual algorithms to be introduced in later chapters.
